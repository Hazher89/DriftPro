<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <title>DriftPro â€“ Tilbakestill passord</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    body { font-family: sans-serif; max-width: 400px; margin: 40px auto; background: #fafbfc; }
    h1 { color: #1a237e; }
    input, button { font-size: 1.1em; margin: 10px 0; width: 100%; padding: 8px; }
    button { background: #1a237e; color: white; border: none; border-radius: 4px; cursor: pointer; }
    #status { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Lag nytt passord</h1>
  <input type="password" id="new-password" placeholder="Nytt passord" />
  <button onclick="resetPassword()">Lagre nytt passord</button>
  <div id="status"></div>
  <script>
    // Bytt ut med dine egne verdier fra Supabase!
    const supabase = supabase.createClient(
      'https://yaibgllmlgrozznwnqcn.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlhaWJnbGxtbGdyb3p6bnducWNuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5NzQ1NTMsImV4cCI6MjA2NzU1MDU1M30.JXHl4_kko9vNWsGggqCRo3Ns__uwrAedRIMf_I6uaT4'
    );

    // Hent access_token fra URL hvis det finnes
    const url = new URL(window.location.href);
    const access_token = url.searchParams.get('access_token');
    const refresh_token = url.searchParams.get('refresh_token');

    // Hvis access_token finnes, logg inn brukeren automatisk
    if (access_token && refresh_token) {
      supabase.auth.setSession({
        access_token,
        refresh_token
      });
    }

    async function resetPassword() {
      const newPassword = document.getElementById('new-password').value;
      if (!newPassword) {
        document.getElementById('status').innerText = 'Skriv inn et nytt passord!';
        return;
      }
      const { error } = await supabase.auth.updateUser({ password: newPassword });
      document.getElementById('status').innerText = error ? error.message : 'Passordet er endret!';
    }
  </script>
</body>
</html>
